# Flibrowser 2
Ржавый крюк для ковыряния в оффлайновых библиотеках с индексом
в формате INPX и книгах, лежащих в зиповых архивах.

## ЧТО УМЕЕТ

Искать книги в своей БД (содержимое БД импортируется из MyHomeLib-совместимого
индексного файла в формате INPX), вытаскивать выбранние книги из архивов
библиотеки и, при необходимости, паковать в отдельные зиповские архивы.

В данной версии (и, вероятно, навсегда) умеет импортировать только
библиотеки вида "сколько-то zip'овских архивов и один файл .inpx".

В первую очередь предназначено для работы под Linux.

Работа под Windows обеспечивается только в виде "хоть как-то",
инсталлятора "поставить всё кучей" нет и не будет.

Работа под чем-то еще (MacOS X, *BSD, экзотические *nix'ы и т.п.)
теоретически возможна (при наличии в целевой ОС всего, перечисленного
в разделе "Что хочет"), но не проверялась, и в обозримом будущем автор
не намерен напрягаться ради этого.


## КАК ЗАПУСКАТЬ

Установки не требует (кроме настройки путей к библиотеке, каталогу
для распаковки книжек и периодического импорта библиотеки).

При первом запуске (или после удаления БД настроек) вываливает окно
первоначальной настройки, и, в случае успешной настройки, пытается
импортировать индексный файл библиотеки.

Запуск:
- под Linux - python3 flibrowser2
- под Windows - pythonw flibrowser

## ПОИСК/ВЫБОР КНИГ

1. Выбрать первую букву имени автора в крайнем левом списке.
2. В следующем списке выбрать автора. Можно сократить список, показав
   только нужных авторов - для этого нужно ввести несколько начальных
   букв имени автора в поле ввода под списком.
3. В списке книг выбрать нужные книги. Список можно сократить, введя
   строку для поиска в поле ввода под списком.
   В отличие от списка авторов, строка ищется в полях "название книги"
   и "название серии/цикла" в любой позиции поля (не только в начале).

## ИЗВЛЕЧЕНИЕ КНИГ ИЗ АРХИВОВ БИБЛИОТЕКИ

В нижней панели выбирается (при необходимости) нужный каталог, после чего
следует нажать кнопку "Извлечь".

Также можно выбрать режим именования файлов и указать, сжимать ли файлы.

При нажатии кнопки "Извлечь" файлы извлекаются из библиотеки в указанный
каталог, и, если это указано, пакуются в отдельные архивы ZIP
(один архив на одну книгу).

Внимание! Если выбран режим именования файлов "Имя автора/...", программа
создаст подкаталоги с именами авторов.

## ЧТО ХОЧЕТ

### ПО:
- Python 3.3 или новее.
- Модуль sqlparse для Python 3.x
- GTK+ 3.14 или новее.
- PythonGObject/PyGI

#### Под Linux
Всё вышеперечисленное устанавливается из репозиториев штатными
средствами ОС.

#### Под Windows
Всё сложнее:

1. С http://python.org берется установщик Python 3.4.x (т.к. на момент написания
   этого README версии 3.5 и новее не поддерживаются виндовым портом PyGObject)
2. PyGObject (с GTK 3.x в комплекте) ищется по ссылкам здесь:
   http://pygobject.readthedocs.io/en/latest/guide/faq.html
   где должен найтись установщик pygi-aio-3.*.exe версии 3.18 или новее.
   В нем при установке нужно указать установленную версию питона,
   выбрать в списках пакетов GTK 3.x и Pango.
   Остальное (вроде бы) не требуется.
3. Установить питоний модуль sqlparse командой:
   python -m pip install sqlparse
4. И, напоминаю, инсталлятора, который будет сам выполнять п.п.1..3 - нет и НЕ БУДЕТ.

...после чего остаётся опять заглянуть в раздел "как запускать".

### Файлы:
БД настроек (settings.sqlite3). Очередность поиска:

1. Каталог настроек (если он существует):
   - под Linux: ~/.config/flibrowser2/
   - под Windows: %APPDATA%\flibrowser2\
2. Каталог, где расположен flibrowser.py

Если БД настроек не существует, то программа создаёт новую, сохранив её
файл в каталоге п.1.

БД библиотеки (library.sqlite3) создаётся автоматически при первом импорте
библиотеки в каталоге:

- под Linux: ~/.local/share/flibrowser2/
- под Windows: %APPDATA%\flibrowser2\

Индексный файл INPX и архивы с книгами. Их расположение указывается при
первом запуске или повторной настройке программы.
